<!DOCTYPE html>

<html>
<head>
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <link href="favicon.ico" rel="shortcut icon">

  <title>Mobile Robots (EMOR) tutorials</title>
  <link href="style.css" rel="stylesheet">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
</head>

<body>
  <div class="page">

    <div class="heading_body">
      <div style="text-align:left; font-size:160%;">
        <strong>Mobile Robots (EMOR)</strong> tutorials.
      </div>
    </div>

    <div class="content_body">
      <div id="menu">
        <a class="top" href="index.html">TRS</a>
        <a href="setup.html">Setup</a>
	<a href="project1.html">Project 1</a>
	        <a class="submenu" href="project1.html#description">Description</a>
	        <a class="submenu" href="project1.html#circle">Moving along a circle</a>
	        <a class="submenu" href="project1.html#square">Moving on the sides of the square</a>
	<a href="project2.html">Project 2</a>
	<a href="api.html">API Documentation</a>
	<a href="tips.html">Tips & Tricks</a>
	<a href="troubleshooting.html">Troubleshooting</a>
      </div>

      <div class="content">
      
<a id="description" name="description"></a>
<h1 style="margin-top: 0">Description</h1>

<p>There are two major goals of the first EMOR tutorial:</p>
<ol>
  <li>Installation of the required software</li>
  <li>Writing two simple programs enabling youBot to mova along two trajectories, i.e. a circle and a square</li>
</ol>

<h2>Installation of the environment</h2>

During the first meeting you are supposed to install the environment, that you will use for the whole EMOR tutorials.
The description the installation procedure can be found at <a href="setup.html">setup</a> website.
For the installation you can get 3p total:
<ol>
  <li>Cloning emor_trs git repository (0.5p)</li>
  <li>Installation of V-Rep (0.5p)</li>
  <li>Preparation of Matlab V-Rep bindings (0.5p)</li>
  <li>Installation of RVC toolbox for Matlab (0.5p)</li>
  <li>Making the abovedescribed software packages to work together (1p)</li>
</ol>


<h2>Generation of trajectories</h2>
Your homework is to prepare two scripts, responsible for:
<ol>
  <li>Generation of a circular trajectory (2p)</li>
  <li>Generation of a "square  trajectory" (2p)</li>
</ol>

<p>In both cases you are supposed to write a program on the basis of the <code>exercise01.m</code> file, by modifying the section between the
<code>% EMOR exercise 01 begin</code> and <code>% EMOR exercise end</code> comments. <b> The rest of the script code should remain unchanged!</b>.

<p>Besides the matlab code we prepared a simulation environment in V-REP stored in file <code>exercise01.ttt</code>.
<b>You must run it before running your matlab script</b>, similarly to the <code>binding_test.ttt</code> during <a href="setup.html#connection_testing">Testing the setup</a>.


<h2>Programming hints</h2>

<p>There are three major methods enabling you to get current robot pose/control its motion:
<ol>
<il><code>simxGetObjectPosition</code> - gets current robot x,y,z Cartesian coordinates. </il>
<il><code>simxGetObjectOrientation</code> - gets current robot orientation (Euler angles). </il>
<il><code>simxSetJointTargetVelocity</code> - sets velocities for all youbot joints, including wheels. </il>
</ol>
However, if one analyse the code he might observe, that they are already used in the (simplified) code of the control loop:
<code class="block">
   while true,

      // Get robot position and orientation.
      [res youbotPos] = vrep.simxGetObjectPosition (...)
      [res youbotEuler] = vrep.simxGetObjectOrientation(...)

      // ...

      %
      % EMOR exercise 01 begin - You can write your code below
      %

      // Place user code here!

      %
      % EMOR exercise end - You can write your code above
      %

      // Update wheel velocities.
      vrep.simxSetJointTargetVelocity(id, h.wheelJoints(1), -forwBackVel-leftRightVel+rotVel, vrep.simx_opmode_oneshot);
      vrep.simxSetJointTargetVelocity(id, h.wheelJoints(2), -forwBackVel+leftRightVel+rotVel, vrep.simx_opmode_oneshot);
      vrep.simxSetJointTargetVelocity(id, h.wheelJoints(3), -forwBackVel-leftRightVel-rotVel, vrep.simx_opmode_oneshot);
      vrep.simxSetJointTargetVelocity(id, h.wheelJoints(4), -forwBackVel+leftRightVel-rotVel, vrep.simx_opmode_oneshot);

      // ...
   end
</code>
This means that you don't in fact neet to use those functions, instead you can simply operate on five variables.

The robot pose is stored in:
<ol>
  <li><code>youbotPos</code> - youbot Cartesian position (x,y,z) [m] </li>
  <li><code>youbotEuler</code> - youbot orientation [rad] </li>
</ol>

Whereas rotation the youBot wheels can be controlled by relative velocities of the robot:
<ol>
  <li><code>forwBackVel</code> - linear velocity along the x axis of the robot [m/s] </li>
  <li><code>leftRightVel</code> - linear velocity along the y axis of the robot [m/s] </li>
  <li><code>rotVel</code> - angular velocity around the z axis of the robot [rad/s] </li>
</ol>
Please notice that such a control is possible thanks to the special construction of robot wheels - mecanum wheels enable to move a vehicle in (almost practically) any direction disregarding its current orientation.


<a id="circle" name="circle"></a>
<h1>Moving along a circle trajectory</h1>

<p>The first trajectory the youBot robot has to follow is a circle.</p>

<h2>Task requirements</h2>
<ol>
  <li>The control program can be implemented as a two state finite state maching (FSM), i.e. aside of the initial state you it will be required to create another state responsible for computation of the required linear and angular velocities.</li>
  <li>It is suggested that in the initialize state you should store the coordinates of the center of the circle.</li>
  <li>The robot can move infinitelly. </li>
  <li>The radius of circle should be equal to 0,5m. </li>
</ol>

<div class="figure" style="width: 580px"><div><img style="border: 1px solid black; width: 560px" src="raster/vrep-circle.jpg" alt="circle" /></div></div>

<a id="square" name="square"></a>
<h1>Following a square trajectory</h1>

<p>The second trajectory is four egdes of a square. You need to provide the youBot with a program that allows it to move along egdes of a square and visit all vertices.</p>

<h2>Task requirements</h2>
<ol>
  <li>The motion along each side of the square should be implemented in separate state of FSM, whereas the transition between states should be triggered by reaching the corner.</li>
  <li>When the robot will reach the first vertex once again, the program should stop. </li>
  <li>The lenght of the edge of the square should be 1m. </li>
</ol>

<div class="figure" style="width: 580px"><div><img style="border: 1px solid black; width: 560px" src="raster/vrep-square.jpg" alt="square" /></div></div>

</div>
      <div class="trailer_body">
        <div style="width: 100%; display: table;">
          <div style="display: table-row">
            <div style="width: 50%; display: table-cell; vertical-align: bottom;">
              Valid <a href="http://validator.w3.org/check?uri=referer">HTML5</a> and <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a>
            </div>

            <div style="width: 50%; display: table-cell; text-align: right; vertical-align: bottom;">
              &copy; Renaud Detry 2014<br>
              This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0 International License</a>.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
